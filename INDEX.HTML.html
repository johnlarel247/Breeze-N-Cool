<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Breeze N Cool - Statistical Report System</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
  body {
    font-family: "Poppins", sans-serif;
    background-color: #f4f6f8;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }
  header {
    background-color: #1e90ff;
    color: white;
    padding: 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  header img {
    height: 60px;
    vertical-align: middle;
    margin-right: 10px;
  }
  header h1 {
    display: inline-block;
    font-size: 24px;
    vertical-align: middle;
  }
  /* Subtle floating breeze animation */
  .breeze {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
  }
  .bubble {
    position: absolute;
    width: 20px;
    height: 20px;
    background: rgba(255,255,255,0.3);
    border-radius: 50%;
    animation: float 10s linear infinite;
  }
  @keyframes float {
    0% { transform: translateY(100%) scale(0.5); opacity:0;}
    50% { opacity:0.7;}
    100% { transform: translateY(-20%) scale(1); opacity:0;}
  }
  .container {
    max-width: 1100px;
    background: white;
    margin: 20px auto;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  form input, form select, button {
    padding: 8px;
    margin: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  button {
    background-color: #1e90ff;
    color: white;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
  }
  button:hover {
    background-color: #005bb5;
    transform: scale(1.05);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
  }
  th {
    background-color: #1e90ff;
    color: white;
  }
  .search-bar {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    margin-bottom: 10px;
    align-items: center;
  }
  .totals {
    text-align: right;
    font-weight: bold;
    margin-top: 10px;
  }
  .delete-btn {
    background-color: #ff4d4d;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
  }
  .delete-btn:hover {
    background-color: #cc0000;
  }
</style>
</head>
<body>
<header>
  <img src="https://i.imgur.com/ZT2XzUP.jpg.jpg" alt="Breeze N Cool Logo" />
  <h1>Breeze N Cool Statistical Report System</h1>
  <div class="breeze"></div>
</header>

<div class="container">
  <h2>Add Record</h2>
  <form id="recordForm">
    <input type="date" id="date" required />
    <input type="text" id="client" placeholder="Client Name" required />
    <input type="text" id="address" placeholder="Address" required />
    <select id="contactType">
      <option value="Tel/Cellphone">Tel/Cellphone</option>
    </select>
    <select id="clientType">
      <option value="Residential">Residential</option>
      <option value="Commercial">Commercial</option>
      <option value="Institutional">Institutional</option>
    </select>
    <input type="text" id="contact" placeholder="Contact" />
    <input type="text" id="hpType" placeholder="HP Type" />
    <input type="text" id="technician" placeholder="Technician" />
    <select id="service">
      <option value="Cleaning">Cleaning</option>
      <option value="Installation">Installation</option>
      <option value="Repair">Repair</option>
      <option value="Relocation">Relocation</option>
      <option value="Check Up">Check Up</option>
    </select>
    <input type="number" id="unit" placeholder="Unit" />
    <input type="number" id="supplier" placeholder="Supplier Charge" />
    <input type="number" id="gross" placeholder="Gross Sale" />
    <input type="number" id="extra" placeholder="Extra Charge" />
    <input type="number" id="deduction" placeholder="Discount/Deduction" />
    <button type="button" id="addBtn">Add Record</button>
  </form>

  <div class="search-bar">
    <div>
      <label for="monthFilter">Filter by Month:</label>
      <select id="monthFilter">
        <option value="">All Months</option>
      </select>
      <button id="filterBtn">Filter</button>
    </div>
    <div>
      <input type="text" id="searchInput" placeholder="Search by name, address, service..." />
      <button id="searchBtn">Search</button>
      <button id="clearSearchBtn">Clear</button>
      <button id="exportCSV">Export CSV</button>
      <button id="exportWord">Export Word</button>
    </div>
  </div>

  <table id="recordTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Client</th>
        <th>Address</th>
        <th>Contact Type</th>
        <th>Client Type</th>
        <th>Contact</th>
        <th>HP Type</th>
        <th>Technician</th>
        <th>Service</th>
        <th>Gross</th>
        <th>Extra</th>
        <th>Deduction</th>
        <th>Net</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="totals" id="totals"></div>
</div>

<script>
let records = JSON.parse(localStorage.getItem("records") || "[]");

// Generate random bubbles for header animation
const breeze = document.querySelector(".breeze");
for(let i=0;i<20;i++){
  let bubble = document.createElement("div");
  bubble.className="bubble";
  bubble.style.left=Math.random()*100+"%";
  bubble.style.width=bubble.style.height=(10+Math.random()*20)+"px";
  bubble.style.animationDuration=(5+Math.random()*10)+"s";
  bubble.style.animationDelay=(Math.random()*5)+"s";
  breeze.appendChild(bubble);
}

function save() {
  localStorage.setItem("records", JSON.stringify(records));
  renderTables();
  populateMonths();
}

function addRecord(obj) {
  records.push(obj);
  save();
}

function deleteRecord(index) {
  if(confirm("Are you sure you want to delete this record?")){
    records.splice(index,1);
    save();
  }
}

function renderTables(list=records){
  const tbody = document.querySelector("#recordTable tbody");
  tbody.innerHTML="";
  let totalGross=0,totalExtra=0,totalDeduct=0,totalNet=0;

  list.forEach((r,i)=>{
    const net=(r.gross+r.extra)-r.deduction;
    totalGross+=r.gross; totalExtra+=r.extra; totalDeduct+=r.deduction; totalNet+=net;
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${r.date}</td>
      <td>${r.client}</td>
      <td>${r.address}</td>
      <td>${r.contactType}</td>
      <td>${r.clientType}</td>
      <td>${r.contact}</td>
      <td>${r.hpType}</td>
      <td>${r.technician}</td>
      <td>${r.service}</td>
      <td>₱${r.gross.toLocaleString()}</td>
      <td>₱${r.extra.toLocaleString()}</td>
      <td>₱${r.deduction.toLocaleString()}</td>
      <td><b>₱${net.toLocaleString()}</b></td>
      <td><button class="delete-btn" onclick="deleteRecord(${i})">Delete</button></td>
    `;
    tbody.appendChild(tr);
  });

  document.getElementById("totals").innerHTML=`
    Total Gross: ₱${totalGross.toLocaleString()} |
    Total Extra: ₱${totalExtra.toLocaleString()} |
    Total Deduction: ₱${totalDeduct.toLocaleString()} |
    <b>Grand Total Net: ₱${totalNet.toLocaleString()}</b>
  `;
}

// Populate month filter dropdown
function populateMonths(){
  const monthSet=new Set(records.map(r=>r.date.slice(0,7)));
  const monthFilter=document.getElementById("monthFilter");
  monthFilter.innerHTML='<option value="">All Months</option>';
  Array.from(monthSet).sort().forEach(m=>{
    const opt=document.createElement("option");
    opt.value=m; opt.text=m; monthFilter.appendChild(opt);
  });
}

document.getElementById("addBtn").addEventListener("click",()=>{
  const obj={
    date:document.getElementById("date").value,
    client:document.getElementById("client").value.trim(),
    address:document.getElementById("address").value.trim(),
    contactType:document.getElementById("contactType").value,
    clientType:document.getElementById("clientType").value,
    contact:document.getElementById("contact").value.trim(),
    hpType:document.getElementById("hpType").value.trim(),
    technician:document.getElementById("technician").value.trim(),
    service:document.getElementById("service").value,
    unit:parseFloat(document.getElementById("unit").value)||0,
    supplier:parseFloat(document.getElementById("supplier").value)||0,
    gross:parseFloat(document.getElementById("gross").value)||0,
    extra:parseFloat(document.getElementById("extra").value)||0,
    deduction:parseFloat(document.getElementById("deduction").value)||0,
  };
  if(!obj.date||!obj.client){ alert("Please fill out Date and Client Name."); return; }
  addRecord(obj);
  document.getElementById("recordForm").reset();
  document.getElementById("date").value=new Date().toISOString().slice(0,10);
});

document.getElementById("searchBtn").addEventListener("click",()=>{
  const q=document.getElementById("searchInput").value.trim().toLowerCase();
  if(!q){ renderTables(); return; }
  const filtered=records.filter(r=>
    r.client.toLowerCase().includes(q)||
    r.address.toLowerCase().includes(q)||
    r.technician.toLowerCase().includes(q)||
    r.service.toLowerCase().includes(q)
  );
  renderTables(filtered);
});

document.getElementById("clearSearchBtn").addEventListener("click",()=>{
  document.getElementById("searchInput").value="";
  renderTables();
});

// Filter per month
document.getElementById("filterBtn").addEventListener("click",()=>{
  const month=document.getElementById("monthFilter").value;
  if(!month){ renderTables(); return; }
  const filtered=records.filter(r=>r.date.startsWith(month));
  renderTables(filtered);
});

// Export CSV with Grand Total
document.getElementById("exportCSV").addEventListener("click",()=>{
  let csv="Date,Client,Address,Contact Type,Client Type,Contact,HP Type,Technician,Service,Gross,Extra,Deduction,Net\n";
  let totalNet=0;
  records.forEach(r=>{
    const net=(r.gross+r.extra)-r.deduction;
    totalNet+=net;
    csv+=`${r.date},${r.client},${r.address},${r.contactType},${r.clientType},${r.contact},${r.hpType},${r.technician},${r.service},${r.gross},${r.extra},${r.deduction},${net}\n`;
  });
  csv+=`,,,,,,,,,,,,"Grand Total Net",${totalNet}\n`;
  const blob=new Blob([csv],{type:"text/csv"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url; a.download="BreezeNCool_Records.csv"; a.click();
  URL.revokeObjectURL(url);
});

// Export Word with Grand Total
document.getElementById("exportWord").addEventListener("click",()=>{
  let totalNet=0;
  let html=`<table border="1" style="border-collapse:collapse; width:100%;">
    <tr><th>Date</th><th>Client</th><th>Address</th><th>Contact Type</th>
    <th>Client Type</th><th>Contact</th><th>HP Type</th><th>Technician</th>
    <th>Service</th><th>Gross</th><th>Extra</th><th>Deduction</th><th>Net</th></tr>`;
  records.forEach(r=>{
    const net=(r.gross+r.extra)-r.deduction;
    totalNet+=net;
    html+=`<tr>
      <td>${r.date}</td><td>${r.client}</td><td>${r.address}</td><td>${r.contactType}</td>
      <td>${r.clientType}</td><td>${r.contact}</td><td>${r.hpType}</td><td>${r.technician}</td>
      <td>${r.service}</td><td>₱${r.gross}</td><td>₱${r.extra}</td><td>₱${r.deduction}</td><td>₱${net}</td>
    </tr>`;
  });
  html+=`<tr><td colspan="12" style="text-align:right;"><b>Grand Total Net</b></td><td>₱${totalNet}</td></tr>`;
  html+="</table>";
  const blob=new Blob(['\ufeff',html],{type:"application/msword"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url; a.download="BreezeNCool_Records.doc"; a.click();
  URL.revokeObjectURL(url);
});

document.getElementById("date").value=new Date().toISOString().slice(0,10);
renderTables();
populateMonths();
</script>
</body>
</html>

